## Forbidden Paths
AUTHOR: LT 'SYREAL' JONES

Description
Can you get the flag?
Here's the website.
We know that the website files live in <code> /usr/share/nginx/html/ </code> and the flag is at <code> /flag.txt </code> but the website is filtering absolute file paths. Can you get past the filter to read the flag?


1)   Path Traversal happening here so just input <code> ../../../../flag.txt </code>

2) https://owasp.org/www-community/attacks/Path_Traversal

<!DOCTYPE html>
<html>
<head>

</head>
<body>
  <h2>How Are Directory Traversal Vulnerabilities Exploited?</h2>
  <p>
    The web server receives a request and appends the <code>../../etc/hosts</code> relative path, specified by the user, to a directory of web pages (<code>/var/www/</code>). This creates a full path: <code>/var/www/html/../../../etc/hosts</code>.
  </p>
  <p>
    In systems like UNIX, the element <code>../</code> traverses a directory in the file system and can give a malicious user access to the file <code>/etc/hosts</code>.
  </p>
  <p>
    Malicious users can use this attack method to access secrets and sensitive information like passwords and database credentials. They can also exploit the vulnerability to carry out further enumeration of the system and obtain the information they need to enable a combined attack through vectors like LFI and RFI.
  </p>
  
  <h2>Directory Traversal Examples</h2>
  <h3>Simple Directory Traversal (dot-dot-slash Attack)</h3>
  <p>
    The simplest example of a directory traversal attack is when an application displays or allows the user to download a file via a URL parameter.
  </p>
  <p>
    For example, if the user provides the file name <code>document.pdf</code>, and the website downloads the PDF to the user’s computer via this URL:
  </p>
  <pre>https://www.vulnerable.com/download_file.php?file=document.pdf</pre>
  <p>
    If the website is hosted on a Linux system, website files are typically stored in <code>/var/www</code>, which is two directories above the root. The attacker can exploit this by passing the following as the file name:
  </p>
  <pre>../../etc/passwd</pre>
  <p>
    If the application does not sanitize inputs, it uses the attacker’s string directly in a system call, switches to the root, and then allows the attacker to access the <code>/etc/</code> directory. It then allows the attacker to access the protected <code>passwd</code> file.
  </p>
  <p>
    A similar attack can be performed on a Windows system using the string <code>\..</code>.
  </p>
  
  <h3>Using Cookies for Directory Traversal</h3>
  <p>
    In many cases, cookies reference directories on a web server to load files required for a website. This exposes the site to a directory traversal attack. For example, consider a cookie that accesses a file to load a new design template for a website:
  </p>
  <pre>
    <?php
        $design = 'new-design.php';
        if (isset($_COOKIE['DESIGN'])) {
            $template = $_COOKIE['DESIGN']; 
        } 
        include("../resources/" . $design); 
    ?>
  </pre>
  <p>
    In this scenario, the name of the file is stored in the DESIGN cookie and appended to a path. Because there is no validation of the <code>$design</code> variable, an attacker can send a GET HTTP request that modifies the cookie value to <code>DESIGN=../../etc/passwd</code>.
  </p>
  <p>
    The web server would then perform the following system call, loading the <code>passwd</code> file instead of the design template.
  </p>
  <pre>include("../skins/../../etc/passwd");</pre>
</body>
</html>
